# 実装プラン（AIコーディング前提 / TDD）

参照：
- `Docs/要件定義書.md`
- `Docs/ChatWork_API仕様.md`

目的：
- Chatwork（CW）の会話を企業単位で統合し、企業/案件/卸/タスク/要約（AI）を一元管理する
- **TDD（テスト→実装）**で進め、途中途中で人間が実行して確認できるチェックポイントを用意する
- **フロントエンド/バックエンドを別フォルダ**で管理する（モノレポ）

---

## 0. まず決めること（ここだけ人間が短時間で確定）

- 認証方式（推奨：アプリ内ユーザー＋ロール / 代替：SSO）
- Chatwork 認証方式（推奨：APIトークンでMVP / 代替：OAuth）
- AI要約のLLMプロバイダ（例：OpenAI / Azure OpenAI / 社内推論基盤）
- 本番DB（推奨：PostgreSQL）
- Git リポジトリ（remote URL と push 権限）

※未確定でも進められるよう、MVPは「設定画面でトークン等を登録」または「環境変数」で開始できる設計にします。

---

## 1. リポジトリ構成（案）

```
/
  frontend/              # UI（React）
  backend/               # API・バッチ（Node.js）
  infra/                 # docker compose / DB等
  Docs/                  # ドキュメント
```

---

## 2. 進め方（AI高速×最小人間介入）

- 1機能=「**テスト追加（失敗）→最小実装→自動検証（lint/test/build/migrate/smoke）→リファクタ**」で小さく反復
- AIがやる（原則）：実装・テスト・ローカル検証・`git commit`/`git push`
- 人間がやる（必須のみ）：
  - 初回：Gitのremote URL提供（リポジトリ作成）と認証設定（pushできる状態にする）
  - 外部連携：Chatworkトークン/LLMキー等の投入（AIは秘密情報を作れないため）
  - 受入：要約の品質など「仕様判断に依存」する最終確認（必要な時だけ）

詳細は `Docs/実装プラン/00_進め方_TDD_運用.md` を参照。

---

## 3. マイルストーン（MVP→拡張）

優先順位は `Docs/要件定義書.md` の Must を先に満たす並びです。

1. 基盤：モノレポ/開発環境/DB/CIの土台  
   - `Docs/実装プラン/01_リポジトリ構成_環境構築.md`
2. 認証・RBAC（NFR-SEC-01/02）  
   - `Docs/実装プラン/02_認証_RBAC.md`
3. DB設計・マイグレーション（主要エンティティ確定）  
   - `Docs/実装プラン/03_DB設計.md`
4. 企業マスタ＋担当者（FR-CMP/FR-CTC）  
   - `Docs/実装プラン/04_企業_担当者.md`
5. ChatWork取り込み（FR-CW / IF-01）  
   - `Docs/実装プラン/05_ChatWork取り込み.md`
6. タイムライン＋全文検索（FR-COM）  
   - `Docs/実装プラン/06_タイムライン_検索.md`
7. タスク管理（FR-TSK）  
   - `Docs/実装プラン/07_タスク管理.md`
8. 企業別AI要約（FR-AI）  
   - `Docs/実装プラン/08_AI要約.md`
9. 案件＋卸（FR-PRJ/FR-WS）  
   - `Docs/実装プラン/09_案件_卸.md`
10. 監査ログ・変更履歴（FR-AUD / NFR-AUD）  
   - `Docs/実装プラン/10_監査_ログ.md`
11. ダッシュボード/設定/エクスポート（FR-DSH/FR-IO/SCR-07）  
   - `Docs/実装プラン/11_ダッシュボード_設定_エクスポート.md`
12. デプロイ/運用（ログ/バックアップ/セキュリティ）  
   - `Docs/実装プラン/12_デプロイ_運用.md`

---

## 4. 受入の最小セット（MVP）

`Docs/要件定義書.md`「最低限のMVP定義」から、まず以下が動く状態を合格ラインにします。

- 企業を作成し、企業にCWルームを紐づけ、メッセージが企業ページに時系列表示され検索できる
- 企業単位で直近7日要約を生成し、履歴として保存できる（自動/手動の区別つき）
- 企業に紐づくタスクを作成でき、担当者のマイタスクで確認できる
- （できれば）案件と卸を登録し、案件→卸先一覧 / 企業→受け卸一覧が相互に参照できる
